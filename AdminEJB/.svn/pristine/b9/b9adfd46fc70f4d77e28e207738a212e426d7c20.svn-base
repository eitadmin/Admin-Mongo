package com.eiw.device.ais140v3;

import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;

public class AIS140GpsDataV3 {
	private String messageId;
	private String packetType;
	private String packetStatus;
	private String vehRegNo;
	private String mainPowerSupply;
	private long mainInputVoltage;
	private String emgStatus;
	private boolean d1Status;
	private boolean d2Status;
	private int direction;

	private String header;
	private Date dateTime;
	private boolean gpsFix;
	private double latitude;
	private String latitudeDir;
	private double longitude;
	private String longitudeDir;
	private int speed;
	private String cellId;
	private String gsmSignal;
	private String satellites;
	private double altitude;
	private long batteryLevel;
	private boolean acc;
	private String diStatus;
	private String tamperingStatus;
	private String doStatus;
	private float ai1;
	private float ai2;
	private String deviceId;
	private Long odometer;
	private String gpsValidity;
	private String gpsProvider;
	private String emergencyMobileNo;
	private String gpsTracking;
	private String voltageLevel;
	private String charge;

	public String getMessageId() {
		return messageId;
	}

	public String getGpsTracking() {
		return gpsTracking;
	}

	public void setGpsTracking(String gpsTracking) {
		this.gpsTracking = gpsTracking;
	}

	public String getVoltageLevel() {
		return voltageLevel;
	}

	public void setVoltageLevel(String voltageLevel) {
		this.voltageLevel = voltageLevel;
	}

	public void setMessageId(String messageId) {
		this.messageId = messageId;
	}

	public String getPacketType() {
		return packetType;
	}

	public void setPacketType(String packetType) {
		this.packetType = packetType;
	}

	public String getPacketStatus() {
		return packetStatus;
	}

	public void setPacketStatus(String packetStatus) {
		this.packetStatus = packetStatus;
	}

	public String getVehRegNo() {
		return vehRegNo;
	}

	public void setVehRegNo(String vehRegNo) {
		this.vehRegNo = vehRegNo;
	}

	public String getHeader() {
		return header;
	}

	public void setHeader(String header) {
		this.header = header;
	}

	public Date getDateTime() {
		return dateTime;
	}

	public void setDateTime(Date dateTime) {
		this.dateTime = dateTime;
	}

	public boolean getGpsFix() {
		return gpsFix;
	}

	public void setGpsFix(boolean gpsFix) {
		this.gpsFix = gpsFix;
	}

	public double getLatitude() {
		return latitude;
	}

	public void setLatitude(float latitude) {
		this.latitude = latitude;
	}

	public String getLatitudeDir() {
		return latitudeDir;
	}

	public void setLatitudeDir(String latitudeDir) {
		this.latitudeDir = latitudeDir;
	}

	public double getLongitude() {
		return longitude;
	}

	public void setLongitude(float longitude) {
		this.longitude = longitude;
	}

	public String getLongitudeDir() {
		return longitudeDir;
	}

	public void setLongitudeDir(String longitudeDir) {
		this.longitudeDir = longitudeDir;
	}

	public int getSpeed() {
		return speed;
	}

	public void setSpeed(int speed) {
		this.speed = speed;
	}

	public String getCellId() {
		return cellId;
	}

	public void setCellId(String cellId) {
		this.cellId = cellId;
	}

	public String getGsmSignal() {
		return gsmSignal;
	}

	public void setGsmSignal(String gsmSignal) {
		this.gsmSignal = gsmSignal;
	}

	public String getSatellites() {
		return satellites;
	}

	public void setSatellites(String satellites) {
		this.satellites = satellites;
	}

	public double getAltitude() {
		return altitude;
	}

	public void setAltitude(double altitude) {
		this.altitude = altitude;
	}

	public long getBatteryLevel() {
		return batteryLevel;
	}

	public void setBatteryLevel(long batteryLevel) {
		this.batteryLevel = batteryLevel;
	}

	public boolean getAcc() {
		return acc;
	}

	public void setAcc(boolean acc) {
		this.acc = acc;
	}

	public String getDiStatus() {
		return diStatus;
	}

	public void setDiStatus(String diStatus) {
		this.diStatus = diStatus;
	}

	public String gettamperingStatus() {
		return tamperingStatus;
	}

	public void settamperingStatus(String tamperingStatus) {
		this.tamperingStatus = tamperingStatus;
	}

	public String getDoStatus() {
		return doStatus;
	}

	public void setDoStatus(String doStatus) {
		this.doStatus = doStatus;
	}

	public float getAi1() {
		return ai1;
	}

	public void setAi1(float ai1) {
		this.ai1 = ai1;
	}

	public float getAi2() {
		return ai2;
	}

	public void setAi2(float ai2) {
		this.ai2 = ai2;
	}

	public String getDeviceId() {
		return deviceId;
	}

	public void setDeviceId(String deviceId) {
		this.deviceId = deviceId;
	}

	public Long getOdometer() {
		return odometer;
	}

	public void setOdometer(Long odometer) {
		this.odometer = odometer;
	}

	public String getGpsValidity() {
		return gpsValidity;
	}

	public void setGpsValidity(String gpsValidity) {
		this.gpsValidity = gpsValidity;
	}

	public String getMainPowerSupply() {
		return mainPowerSupply;
	}

	public void setMainPowerSupply(String mainPowerSupply) {
		this.mainPowerSupply = mainPowerSupply;
	}

	public long getMainInputVoltage() {
		return mainInputVoltage;
	}

	public void setMainInputVoltage(long mainInputVoltage) {
		this.mainInputVoltage = mainInputVoltage;
	}

	public String getEmgStatus() {
		return emgStatus;
	}

	public void setEmgStatus(String emgStatus) {
		this.emgStatus = emgStatus;
	}

	public boolean isD1Status() {
		return d1Status;
	}

	public void setD1Status(boolean d1Status) {
		this.d1Status = d1Status;
	}

	public boolean isD2Status() {
		return d2Status;
	}

	public void setD2Status(boolean d2Status) {
		this.d2Status = d2Status;
	}

	public String getTamperingStatus() {
		return tamperingStatus;
	}

	public void setTamperingStatus(String tamperingStatus) {
		this.tamperingStatus = tamperingStatus;
	}

	public int getDirection() {
		return direction;
	}

	public void setDirection(int direction) {
		this.direction = direction;
	}

	public String getGpsProvider() {
		return gpsProvider;
	}

	public void setGpsProvider(String gpsProvider) {
		this.gpsProvider = gpsProvider;
	}

	public void reademr(String[] deviceData) {
		this.packetType = deviceData[4];
		this.packetStatus = deviceData[2];
		this.dateTime = getDateDDMMYYYYHHMMSS(deviceData[5]);
		System.out.println("DateTime Tracking Packet :" + dateTime);
		System.out.println("DateTime EMR Packet :" + dateTime);
		this.gpsValidity = deviceData[11];
		System.out.println("GPS Validity EMR Packet:" + gpsValidity);
		this.latitude = Double.valueOf(deviceData[7]);
		this.latitudeDir = deviceData[8];
		this.longitude = Double.valueOf(deviceData[9]);
		this.longitudeDir = deviceData[10];
		if (!deviceData[8].equalsIgnoreCase("N")) {
			this.latitude = -this.latitude;
		}
		if (!deviceData[10].equalsIgnoreCase("E")) {
			this.longitude = -this.longitude;
		}
		this.altitude = Float.valueOf(deviceData[11]);
		float speedf = Float.parseFloat(deviceData[12]);
		this.speed = Math.round(speedf);
		System.out.println("EMR Altitude :" + altitude + " Speed :" + speed);
		float odometer = Float.valueOf(deviceData[13].toString());
		this.odometer = (long) Math.round(odometer);
		this.gpsFix = deviceData[14].equalsIgnoreCase("G") ? true : false;
		this.gpsProvider = deviceData[14];
		this.vehRegNo = deviceData[15];
		this.emergencyMobileNo = deviceData[16];
	}

	public void read(String[] deviceData) {
		this.packetType = deviceData[4];
		this.messageId = deviceData[5];
		this.packetStatus = deviceData[6];
		this.vehRegNo = deviceData[8];
		this.gpsFix = deviceData[9].equalsIgnoreCase("1") ? true : false;

		this.dateTime = getDateDDMMYYYYHHMMSS(deviceData[10] + deviceData[11]);
		System.out.println("DateTime Tracking Packet :" + dateTime);

		this.latitude = Float.valueOf(deviceData[12]);
		this.latitudeDir = deviceData[13];
		this.longitude = Float.valueOf(deviceData[14]);
		this.longitudeDir = deviceData[15];
		if (!deviceData[13].equalsIgnoreCase("N")) {
			this.latitude = -this.latitude;
		}
		if (!deviceData[15].equalsIgnoreCase("E")) {
			this.longitude = -this.longitude;
		}

		float speedf = Float.parseFloat(deviceData[16]);
		this.speed = (Math.round(speedf));
		this.direction = (int) Float.parseFloat(deviceData[17]);
		this.satellites = deviceData[18];
		this.altitude = Float.valueOf(deviceData[19]);
		this.acc = deviceData[23].equalsIgnoreCase("1") ? true : false;
		this.mainPowerSupply = deviceData[24];
		float mainIpVolt = Float.parseFloat(deviceData[25]) * 1000;
		this.mainInputVoltage = (long) mainIpVolt;
		System.out.println("Main Input voltage in volts :" + deviceData[25]
				+ " in millvolts" + mainInputVoltage);
		System.out.println("Main Power Supply :" + mainPowerSupply);
		float bat = Float.parseFloat(deviceData[26]) * 1000;
		this.batteryLevel = (long) bat;
		System.out.println("Internal battery voltage in volts :"
				+ deviceData[26] + " in millvolts :" + batteryLevel);
		this.emgStatus = deviceData[27];
		this.tamperingStatus = deviceData[28];
		this.gsmSignal = deviceData[29].trim();
		System.out.println("Satellites :" + satellites + " Gsm Signal :"
				+ gsmSignal + " Emergency Status :" + emgStatus + "Altitude :"
				+ altitude);
		this.cellId = deviceData[33];
		this.diStatus = deviceData[46];
		this.doStatus = deviceData[47];
		this.gpsTracking = deviceData[9].equalsIgnoreCase("1") ? "ON" : "OFF";

		if (bat > 60000) {
			this.voltageLevel = "Very High";
		} else if (bat > 50000 && bat <= 60000) {
			this.voltageLevel = "High";
		} else if (bat > 40000 && bat <= 50000) {
			this.voltageLevel = "Medium";
		} else if (bat > 30000 && bat <= 40000) {
			this.voltageLevel = "Low";
		} else if (bat > 10000 && bat <= 30000) {
			this.voltageLevel = "Very Low";
		} else if (bat > 0 && bat <= 10000) {
			this.voltageLevel = "Extremely Low";
		} else {
			this.voltageLevel = "No Power";
		}

		this.charge = deviceData[24].equalsIgnoreCase("1") ? "ON" : "OFF";

		System.out.println("Direction :" + direction);
	}

	public String getCharge() {
		return charge;
	}

	public void setCharge(String charge) {
		this.charge = charge;
	}

	public Date getDateDDMMYYYYHHMMSS(String str) {
		SimpleDateFormat sdf = new SimpleDateFormat("ddMMyyyyHHmmss");
		try {
			Date timeStampStr1 = sdf.parse(str);
			return timeStampStr1;
		} catch (Exception e) {
			return null;
		}

	}

	public String getEmergencyMobileNo() {
		return emergencyMobileNo;
	}

	public void setEmergencyMobileNo(String emergencyMobileNo) {
		this.emergencyMobileNo = emergencyMobileNo;
	}
}
